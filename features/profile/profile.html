<section id="profile">
  <h2>Your Profile</h2>
  <p>Username: <strong id="profile-username"></strong></p>


<div class="search-history-container">
  <input 
    type="text" 
    id="search-history" 
    placeholder="üîç Search your BMI, mood, or quiz history..." 
    style="width:100%;padding:10px;border-radius:8px;border:1px solid #ccc;margin-bottom:10px;">
  <div id="search-results" style="max-height:300px;overflow-y:auto;"></div>
</div>



  
  <div class="profile-section">
    <h3>BMI History</h3>
    <ul id="profile-bmi-list"></ul>
  </div>
  
  <div class="profile-section">
    <h3>Mood History</h3>
    <ul id="profile-mood-list"></ul>
  </div>
  
  <div class="profile-section">
    <h3>Your Body Shape Quiz Results</h3>
    <ul id="profile-quiz-list"></ul>
  </div>
  
  <div class="profile-btn-row">
    <button id="profile-settings-btn" style="background:#fbbf24; color:#fff;">Settings</button>
    <button id="view-report-btn" style="background:#6a82fb; color:#fff;">View Report</button>
    <button id="profile-back-btn" onclick="FeatureHandler.showPage('menu')">Back to Menu</button>
  </div>
  
  <!-- Modal Settings (UPDATED) -->
  <div id="profile-settings-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.25); z-index:9999; align-items:center; justify-content:center;">
    <div style="background:#fff; border-radius:16px; max-width:400px; width:90vw; margin:auto; padding:2em 1.5em; box-shadow:0 8px 32px #0002; position:relative;">
      <h3 style="margin-top:0; color:#667eea;">Account Settings</h3>
      
      <form id="edit-profile-form" style="display:flex; flex-direction:column; gap:1em; align-items:stretch;">
        <!-- Current Password (Required) -->
        <div style="background:#fff3cd; border-left:4px solid #ffd555; padding:0.8em; border-radius:8px; margin-bottom:0.5em;">
          <small style="color:#856404; display:block; margin-bottom:0.3em;">
            ‚ö†Ô∏è <strong>Security Verification Required</strong>
          </small>
          <small style="color:#856404;">
            Enter your current password to make changes
          </small>
        </div>
        
        <div style="position:relative;">
          <label style="display:block; margin-bottom:0.3em; color:#4a5568; font-size:0.9em; font-weight:600;">
            Current Password <span style="color:#f87171;">*</span>
          </label>
          <input 
            type="password" 
            id="current-password" 
            placeholder="Enter current password" 
            required
            style="padding:0.7em; border-radius:8px; border:2px solid #cbd5e0; width:100%; box-sizing:border-box; transition:border-color 0.3s;">
        </div>
        
        <hr style="border:none; border-top:1px solid #e2e8f0; margin:0.5em 0;">
        
        <!-- New Username (Optional) -->
        <div style="position:relative;">
          <label style="display:block; margin-bottom:0.3em; color:#4a5568; font-size:0.9em; font-weight:600;">
            New Username (optional)
          </label>
          <input 
            type="text" 
            id="edit-username" 
            placeholder="Leave empty to keep current" 
            minlength="3" 
            maxlength="15" 
            pattern="^[a-zA-Z0-9_]+$" 
            style="padding:0.7em; border-radius:8px; border:2px solid #cbd5e0; width:100%; box-sizing:border-box;">
          <small style="color:#718096; display:block; margin-top:0.3em;">
            3-15 characters (letters, numbers, underscore only)
          </small>
        </div>
        
        <!-- New Password (Optional) -->
        <div style="position:relative;">
          <label style="display:block; margin-bottom:0.3em; color:#4a5568; font-size:0.9em; font-weight:600;">
            New Password (optional)
          </label>
          <input 
            type="password" 
            id="edit-password" 
            placeholder="Leave empty to keep current" 
            minlength="6" 
            style="padding:0.7em; border-radius:8px; border:2px solid #cbd5e0; width:100%; box-sizing:border-box;">
          <small style="color:#718096; display:block; margin-top:0.3em;">
            Minimum 6 characters (contains letters, numbers, and symbols)
          </small>
        </div>
        
        <!-- Action Buttons -->
        <button type="submit" id="save-profile-btn" style="background:#45c797; color:#fff; padding:0.8em; border-radius:8px; border:none; font-weight:600; cursor:pointer; transition:all 0.3s;">
          Save Changes
        </button>
        
        <button type="button" id="delete-account-btn" style="background:#e56e6e; color:#fff; padding:0.8em; border-radius:8px; border:none; font-weight:600; cursor:pointer; transition:all 0.3s;">
          Delete Account
        </button>
        
        <button type="button" id="close-settings-btn" style="background:#757f8f; color:#fff; padding:0.8em; border-radius:8px; border:none; font-weight:600; cursor:pointer; transition:all 0.3s;">
          Back
        </button>
      </form>
    </div>
  </div>
</section>

<!-- Report Section (Same as before) -->
<section id="report" style="display:none;">
  <div class="report-container">
    <div class="report-header">
      <h2>Complete Health Report</h2>
      <p class="report-username">User: <strong id="report-username"></strong></p>
      <p class="report-date">Generated: <span id="report-date"></span></p>
    </div>
    
    <div class="report-content">
      <!-- BMI Report -->
      <div class="report-card">
        <div class="report-card-header">
          <h3>BMI History</h3>
          <span class="report-count" id="bmi-count">0 records</span>
        </div>
        <div class="report-card-body">
          <ul id="report-bmi-list"></ul>
        </div>
      </div>
      
      <!-- Mood Report -->
      <div class="report-card">
        <div class="report-card-header">
          <h3>Mood Tracker History</h3>
          <span class="report-count" id="mood-count">0 records</span>
        </div>
        <div class="report-card-body">
          <ul id="report-mood-list"></ul>
        </div>
      </div>
      
      <!-- Quiz Report -->
      <div class="report-card">
        <div class="report-card-header">
          <h3>Body Shape Quiz Results</h3>
          <span class="report-count" id="quiz-count">0 records</span>
        </div>
        <div class="report-card-body">
          <ul id="report-quiz-list"></ul>
        </div>
      </div>
    </div>
    
    <div class="report-actions">
      <button id="download-report-btn" class="btn-download">Print Report</button>
      <button id="back-to-profile-btn" class="btn-back">Back to Profile</button>
    </div>
  </div>
</section>